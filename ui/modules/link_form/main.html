<div class="link_form">

    <div class="hackpad_modal_container">
        <div id="hackpad_modal" class="modal hide fade" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">Ã—</button>
            <h3>Change Hackpad</h3>
          </div>
          <div class="modal-body">
              <input type="radio" name="hackpad_type" id="hackpad_type_new" value="new" />
              <label for="hackpad_type_new">New Hackpad</label>
              <br/>
              <input type="radio" name="hackpad_type" id="hackpad_type_url" value="url" />
              <label for="hackpad_type_url">Hackpad by URL</label>
              <input type="text" name="hackpad_url" placeholder="Hackpad URL" />
              <br/>
              <input type="radio" name="hackpad_type" id="hackpad_type_empty" value="empty" />
              <label for="hackpad_type_empty">Empty</label>
          </div>
          <div class="modal-footer">
            <button class="btn" data-dismiss="modal" aria-hidden="true">Close</button>
            <button class="btn btn-primary" id="save_hackpad_btn">Save changes</button>
          </div>
        </div>
    </div>
  <form action="/links{{ ('/' + str(model.id)) if model.id else '' }}" method="post" class="post_form">
      <div class="form_contents">
          {% module xsrf_form_html() %}
          {% set hackpad_icon = lambda x: '<div class="input-prepend hackpad_input"><span class="add-on">'\
                                              '<img src="/static/images/hackpad_icon.png" alt="hackpad"></span>%s</div>' % x
                                          %}

          {% set link_icon = lambda x: '<div class="input-prepend"><span class="add-on">'\
                                              '<i class="icon-bookmark"></i></span>%s</div>' % x
          %}
          {% set wrap_text = lambda x: '<div class="text_wrapper">%s</div>' % x %}
          {% set form_fields = [
          {
            'name': 'title',
            'placeholder': 'Title...',
            'wrapper': wrap_text,
          },
          {
            'name': 'url',
            'placeholder': 'Linked URL (optional)',
            'wrapper': link_icon,
          },
          {
            'name': 'body_raw',
            'placeholder': 'Body',
          },
          {
            'name': 'hackpad_url',
            'placeholder': 'Hackpad URL',
            'wrapper': hackpad_icon,
          },
          {
            'name': 'featured',
            'label': '<i class="icon-star"></i>&nbsp;Feature this post?',
            'label_selected': '<i class="icon-remove"></i>&nbsp;Un-feature this post',
          }]
          %}

          {% if model.id %}
              {% set form_fields = form_fields + [{
                'name': 'deleted',
                'label': '<i class="icon-remove"></i>&nbsp;Delete this post?',
                'label_selected': '<i class="icon-remove"></i>&nbsp;Un-delete this post',
              }]%}
          {% end %}

          {% for name, html, field_errors in model.form_fields(errors, form_fields=form_fields) %}
                  {% if field_errors %}
                      <i>{{ field_errors.message }}</i>
                      <br/>
                  {% end %}
                  {% raw html %}
          {% end %}
          <div class="text_wrapper">
            <input type="text" name="tags" placeholder="Categories (optional, separate by commas)" />
          </div>
          <div class="post_submit_bar">
            <div class="btn">
              <div class="icon-plus-sign">
              </div>
              Submit this content
            </div>
          </div>
      </div>
  </form>
</div>
