{% if user %}
    {% set username = user.get('username') %}

    {% set voted_users = [u['username'] for u in object.voted_users] %}
    {% set user_voted = username in voted_users %}

    {% set path = '%ss' % object._class_name.split('.')[1].lower() %}

    {% set detail_url = '?detail=true' if globals().get('detail') else '' %}

    <ul class="{{ "voted" if user_voted else "voting" }} hidden-phone vote_button">
        <li>
            <span class="green"><div class="icon-arrow-up">&nbsp;</div></span>
            <a href="/{{ path }}/{{ object.id }}/upvote{{ detail_url }}">{{ object.votes }}</a>
        </li>
    </ul>
    {% end %}
