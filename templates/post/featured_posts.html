{% extends '../base.html' %}

{% block body_class %}conversation{% end %}

{% block content %}
  <div id="main" role="main">
    <section class=" centered clearfix">
      <h2 class="section-heading" style="margin-top:0">Featured Posts</h2>
      <div class="row">
        {% for post in featured_posts %}
          <div class="featured-post">
            <div class="content">
              <a class="title" href="/posts/{{ post['slug'] }}">{{ post['title'] }}</a>
              {% if post['url'] %}
                <a href="{{ post['url'] }}" class="source" target="_blank">{{ urlparse(post['url']).netloc }}</a>
              {% else %}
                <a href="/posts/{{ post['slug'] }}" class="source">usv.com</a>
              {% end %}
              <div class="excerpt">{{ post['body_truncated'] }}</div>
              <div class="meta">
                <div class="thumbnail">
                  <a href="http://www.twitter.com/{{ post['user']['username'] }}" target="_blank">
                    <img title="{{ post['user']['username'] }}" src="{{ post['user']['profile_image_url_https'] }}" alt="thumbnail">
                  </a>
                </div>
                @{{ post['user']['username'] }}
                <span class="time">{{ template_helpers.pretty_date(post['date_created']) }}</span>
                <a href="/posts/{{ post['slug'] }}/upvote" class="votes-count ajax_upvote_link upvote-button">
                  <i class="icon-arrow-up icon"></i>
                  <span class="value">{{ post['votes'] }} vote{{ 's' if post['votes'] != 1 else '' }}</span>
                </a>
                <a class="dsq-comment-count" href="/posts/{{ post['slug'] }}" data-disqus-url="/posts/{{post['slug']}}" data-disqus-identifier="{{ str(post['_id']) }}" target="_blank">{{ post['comment_count'] }} comment{{ 's' if post['comment_count'] != 1 else '' }}</a>
              </div>
            </div>
          </div>
        {% end %}
      </div>
      {% if pages > 1 %}
        <div id="pagination">
          <ul>
            {% if previous %}
              <li><a href="{{ get_page_url(previous) }}">&laquo;</a></li>
            {% else %}
              <li class="disabled"><span>&laquo;</span></li>
            {% end %}
            {% if show_pages == True %}
              {% for page_num in page_range %}
                {% if page_num != page %}
                  <li><a href="{{ get_page_url(page_num) }}">{{ page_num }}</a></li>
                {% else %}
                  <li class="active"><span>{{ page_num }}</span></li>
                {% end %}
              {% end %}
            {% end %}
            {% if next %}
              <li><a href="{{ get_page_url(next) }}">&raquo;</a></li>
            {% else %}
              <li class="disabled"><span>&raquo;</span></li>
            {% end %}
          </ul>
        </div>
      {% end %}
    </section>
  </div>
{% end %}

{% block javascript %}
  <script>
    $(document).ready(function() {
      rp_max_height = 0;
      $('.featured-post').each(function() {
        if ($(this).height() > rp_max_height) {
          rp_max_height = $(this).height();
        }
      })
      $('.featured-post').height(rp_max_height);
    });
  </script>
{% end %}

