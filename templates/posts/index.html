{% extends "../base.html" %}

{% block title %}Posts{% end %}

{% block css %}
<link href="/static/css/home.css" rel="stylesheet">
{% end %}

{% block javascript %}
<script type="text/javascript">
    $(document).ready(function() {
        $(".post .post_content").ellipsis();
    });
</script>
{% end %}

{% block content %}
<div class="container-fluid">
<div class="row-fluid">
   <div class="span4 featured-posts navbar">
        <div class="navbar-inner" style="margin: 0px 0px 15px 0px; height: 58px;">
          <p class="section_label">Featured Posts</a>
        </div>
        {% for post in featured_posts %}
                <div class="post">
                <h1>
                    <a href="/posts/{{ post.id }}">{{ post.title }}</a>
                </h1>

                <p class="post_info">
                    {% if post.user.auth_type == 'twitter' %}
                        <span class="icon-user"></span> 
                        <a href="http://twitter.com/{{ post.user.username }}">
                            @{{ post.user.username }}
                        </a>
                    {% end %}
                    on
                    <a href="/posts/{{ post.id }}">{{ post.date_created.strftime("%B %d, %Y") }}</a>
                </p>

                <div class="post_content">
                    {% raw post.body_html %}
                </div>
            </div>
        {% end %}
    </div>

    <div class="span8 community-posts">
        <div class="top-bar navbar">
          <div class="tags span12 navbar-inner">
              <p class="section_label">USV Community</p>
              <input type="text" name="search" value="Search..." class="search-query content_search" />
              {% module Template("components/tags_view.html", objects=tags, current_tag=current_tag, view_type="posts") %}
          </div>
        </div>
        <br/>
        {% for post in posts %}
            {% set path = '%ss' % post._class_name.split('.')[1].lower() %}
            <div class="post">
                <ul class="{{ "voted" if user['username'] in [u['username'] for u in post.voted_users] else "voting" }}">
                    <li>
                        <span class="green"><div class="icon-arrow-up">&nbsp;</div></span>
                        <a href="/{{ path }}/{{ post.id }}/upvote">{{ post.votes }}</a>
                    </li>
                </ul>

                <div class="contents">
                  {% if post.title %}
                      <h1>
                        <a href="/{{ path }}/{{ post.id }}">{{ post.title }}</a>
                      </h1>
                    {% else %}
                      <a href="/{{ path }}/{{ post.id }}" class="tweet_title">
                        {{ post.body_raw }}
                      </a>
                    {% end %}

                    <p class="post_info">
                        {% if post.user.auth_type == 'twitter' %}
                            <span class="icon-user"></span> 
                            <a href="http://twitter.com/{{ post.user.username }}">
                                @{{ post.user.username }}
                            </a>
                        {% end %}
                        &nbsp;
                        <span class="icon-calendar"></span>
                        <a href="#">{{ post.date_created.strftime("%B %d, %Y") }}</a>
                        &nbsp;
                        <span class="icon-comment"></span>&nbsp;<a href="/{{ path }}/{{ post.id }}#disqus_thread"></a>
                    </p>
                </div>
            </div>
        {% end %}
        <div class="pagination">
          <ul>
            <li><a href="#">Prev</a></li>
            <li><a href="#">1</a></li>
            <li><a href="#">2</a></li>
            <li><a href="#">3</a></li>
            <li><a href="#">4</a></li>
            <li><a href="#">Next</a></li>
          </ul>
        </div>
    </div>

</div>
</div>

<script type="text/javascript">
/* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
var disqus_shortname = 'usv'; // required: replace example with your forum shortname

/* * * DON'T EDIT BELOW THIS LINE * * */
(function () {
    var s = document.createElement('script'); s.async = true;
    s.type = 'text/javascript';
    s.src = 'http://' + disqus_shortname + '.disqus.com/count.js';
    (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
}());
</script>
{% end %}
